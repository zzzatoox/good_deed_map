{% extends 'base.html' %} {% load static %} {# Заголовок страницы #} 
{% block title %}Карта добрых дел{% endblock %} {# Дополнительные стили #} 
{% block extra_css %}
<link href="{% static 'css/index.css' %}" rel="stylesheet" />
{% endblock %} {# Специальный класс для body - фиксированная высота для карты #}
{% block body_class %}overflow-hidden{% endblock %} 
{# Класс для main - убираем отступы #} {% block main_class %}{% endblock %} 
{# Используем стандартный header из partials/header.html #} {# Отключаем футер на главной странице #} 
{% block footer %} {% endblock %} {# Основной контент #} {% block content %} 
{# Модальное окно НКО #} {% include 'partials/nko_modal.html' %} 
{# Главный контейнер с картой и фильтрами #}
<main class="main-container flex flex-col md:flex-row">
  {# Левая панель с фильтрами #} {% include 'partials/filter_panel.html' %} 
  {# Контейнер с картой (правая часть) #}
  <div
    id="map"
    class="map-container min-h-[400px] md:min-h-0 bg-gray-200 dark:bg-gray-900 relative"
  >
    {# Карта инициализируется через JavaScript #}
  </div>
</main>

{% endblock %} {# JavaScript #} {% block scripts %} 
{# Подключение Яндекс Карт API #}
<script
  src="https://api-maps.yandex.ru/2.1/?apikey={{ YANDEX_MAPS_API_KEY }}&lang=ru_RU"
  type="text/javascript"
></script>

{# Основной скрипт инициализации карты и UI #}
<script type="module">
  import { fetchAndInit } from '{% static "js/main.js" %}';

  // Ожидаем загрузки Яндекс Карт, затем инициализируем
  function tryInit() {
    if (typeof ymaps !== "undefined") {
      fetchAndInit();
    } else {
      setTimeout(tryInit, 200);
    }
  }
  tryInit();
</script>
{% endblock %} {# Скрипт переключения темы #}
<script>
  // Инициализация темной темы
  const themeToggleBtn = document.getElementById("theme-toggle");
  const htmlElement = document.documentElement;

  if (
    localStorage.theme === "dark" ||
    (!("theme" in localStorage) &&
      window.matchMedia("(prefers-color-scheme: dark)").matches)
  ) {
    htmlElement.classList.add("dark");
  } else {
    htmlElement.classList.remove("dark");
  }

