{% extends 'base.html' %} {% load static %} 
{# Базовый шаблон для страниц с формами НКО Используется для: - Добавления НКО (add_nko.html) - Редактирования НКО (edit_nko.html) - Передачи прав (transfer_ownership.html) Включает: - Фоновую карусель изображений - Адаптивную сетку для форм - Темную тему #}\
{% block extra_css %}
<link href="{% static 'css/add_nko.css' %}" rel="stylesheet" />
<style>
  /* Убираем горизонтальную прокрутку */
  html,
  body {
    overflow-x: hidden;
    max-width: 100vw;
  }

  /* Адаптивная карточка формы */
  .nko-card {
    width: 100%;
    max-width: min(980px, 96vw);
    margin: 0 auto;
  }

  /* Адаптивные поля ввода */
  .nko-card input,
  .nko-card textarea,
  .nko-card select {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  /* Адаптивная сетка для форм */
  .form-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  @media (min-width: 768px) {
    .form-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1.5rem;
      align-items: start;
    }
  }

  /* Мобильная оптимизация */
  @media (max-width: 480px) {
    .nko-card {
      border-radius: 1rem;
      padding: 1rem;
    }

    header {
      padding-left: 1rem;
      padding-right: 1rem;
    }

    header img {
      max-width: 140px;
    }
  }

  /* Скролл для категорий */
  .categories-container {
    max-height: 40vh;
    overflow-y: auto;
  }

  @media (min-width: 768px) {
    .categories-container {
      max-height: 30vh;
    }
  }
</style>
{% endblock %} {# Используем bg-gray-100 вместо bg-gray-50 из base.html #} 
{% block body_class %}bg-gray-100 dark:bg-gray-900{% endblock %} 
{# Используем общий header как на главной странице #} 
{# header block наследуется из base.html - не переопределяем #} {# Отключаем футер #} 
{% block footer %}{% endblock %} {% block content %} {# Фоновая карусель #} 
{% include 'partials/background_carousel.html' %} {# Основной контент формы #}
<main
  class="relative z-10 flex items-center justify-center min-h-[calc(100vh-80px)] py-4 px-3 sm:px-4"
>
  <div
    class="nko-card bg-gradient-to-r from-[#15256D] to-[#4495D1] rounded-2xl sm:rounded-3xl shadow-xl p-4 sm:p-6 lg:p-8 dark:from-gray-800 dark:to-gray-700"
  >
    {# Заголовок формы - переопределяется в дочерних шаблонах #}
    <h2
      class="text-xl sm:text-2xl font-extrabold text-white mb-4 sm:mb-6 text-center drop-shadow-lg dark:text-gray-100"
    >
      {% block form_title %}Форма НКО{% endblock %}
    </h2>

    {# Контент формы - переопределяется в дочерних шаблонах #} 
    {% block form_content %}{% endblock %}
  </div>
</main>
{% endblock %} {% block scripts %} {# JavaScript для фоновой карусели #}
<script>
  (function () {
    let currentBackground = 0;
    const backgrounds = document.querySelectorAll("#background-carousel > div");

    function changeBackground() {
      if (!backgrounds || backgrounds.length === 0) return;

      backgrounds[currentBackground].classList.remove("opacity-70");
      backgrounds[currentBackground].classList.add("opacity-0");

      currentBackground = (currentBackground + 1) % backgrounds.length;

      backgrounds[currentBackground].classList.remove("opacity-0");
      backgrounds[currentBackground].classList.add("opacity-70");
    }

    setInterval(changeBackground, 5000);
  })();
</script>

{# Подключаем IMask.js для маски телефона #}
<script src="https://unpkg.com/imask@7.6.1/dist/imask.min.js"></script>

{# Подключаем скрипт маски телефона #}
<script src="{% static 'js/phone-mask.js' %}"></script>

{# Подключаем модуль add_nko.js для валидации и автодополнения #}
<!-- Передаём Yandex Maps API key в window (безопасно: публичный JS-ключ)
     Не кладите сюда приватный геокодер-ключ, используйте его только на сервере. -->
<script>
  window.YANDEX_MAPS_API_KEY = "{{ YANDEX_MAPS_API_KEY|escapejs }}";
  window.YANDEX_MAPS_GEO_API_KEY = "{{ YANDEX_MAPS_GEO_API_KEY|escapejs }}";
</script>
<script type="module" src="{% static 'js/add_nko.js' %}"></script>
<script src="{% static 'js/address_autocomplete.js' %}"></script>
{% endblock %}
