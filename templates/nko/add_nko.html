{% extends 'nko/nko_base.html' %} {% load static %} {# Заголовок страницы #} 
{% block title %}Добавить НКО - Карта добрых дел{% endblock %} 
{# Заголовок формы #} 
{% block form_title %}Добавить новое НКО{% endblock %} {# Содержимое формы #}
{% block form_content %}
<form method="post" enctype="multipart/form-data" class="w-full" id="ngo-form">
  {% csrf_token %}
  
  {# Общие ошибки формы #}
  {% if form.non_field_errors %}
  <div class="mb-4 bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded dark:bg-red-900/30 dark:text-red-200">
    {{ form.non_field_errors }}
  </div>
  {% endif %}

  <div class="form-grid">
    {# Основная колонка #}
    <div class="space-y-4 min-w-0">
      {# Название НКО #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Название НКО
        </label>
        {{ form.name }}
        {% if form.name.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.name.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Категории #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Направление деятельности (можно выбрать несколько)
        </label>
        <div
          class="categories-container bg-white bg-opacity-90 rounded-xl border-2 border-white p-3 sm:p-4 shadow-md dark:bg-gray-700 dark:border-gray-600"
        >
          {{ form.categories }}
        </div>
        {% if form.categories.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.categories.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Описание #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Описание НКО
        </label>
        {{ form.description }}
        {% if form.description.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.description.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Функционал волонтеров #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Функционал волонтеров (опционально)
        </label>
        {{ form.volunteer_functions }}
        {% if form.volunteer_functions.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.volunteer_functions.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Адрес #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Адрес
        </label>
        {{ form.address }}
        {% if form.address.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.address.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </div>

    {# Боковая колонка #}
    <aside class="space-y-4 min-w-0">
      {# Город #}
      <div class="autocomplete">
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Город
        </label>
        {{ form.city }}
        {% if form.city.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.city.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Логотип #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Логотип (опционально)
        </label>
        <div
          class="file-input-container bg-white bg-opacity-90 rounded-xl border-2 border-white p-3 shadow-md dark:bg-gray-700 dark:border-gray-600"
        >
          {{ form.logo }}
          <div
            id="logo-validation"
            class="file-validation-message"
            aria-live="polite"
          ></div>
          <p class="text-xs text-gray-700 mt-2 italic dark:text-gray-300">
            * Допустимые форматы: PNG, JPG и JPEG
          </p>
        </div>
        {% if form.logo.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.logo.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Сайт #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Сайт (опционально)
        </label>
        {{ form.website }}
        {% if form.website.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.website.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Соцсеть #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Соцсеть (опционально)
        </label>
        {{ form.other_social }}
        {% if form.other_social.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.other_social.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Телефон #}
      <div>
        <label
          class="block text-white text-sm font-medium mb-2 dark:text-gray-200"
        >
          Контактный телефон (опционально)
        </label>
        {{ form.phone }}
        {% if form.phone.errors %}
        <div class="mt-1 text-red-200 text-sm bg-red-500/20 border border-red-400 rounded p-2">
          {% for error in form.phone.errors %}
          <p>❌ {{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      {# Кнопки #}
      <div class="space-y-3">
        <button
          type="submit"
          class="w-full py-3 bg-white text-[#15256D] font-bold text-base sm:text-lg rounded-xl transition-all duration-300 shadow-lg dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 hover:shadow-xl active:scale-95"
        >
          Отправить на модерацию
        </button>

        <a
          href="{% url 'index' %}"
          class="block text-center py-2 bg-white/20 text-white rounded-xl hover:opacity-90"
        >
          Вернуться на главную
        </a>
      </div>
    </aside>
  </div>
  {# Hidden fields for coordinates (filled by JS) #}
  <div style="display:none;">
    {{ form.latitude }}
    {{ form.longitude }}
  </div>
</form>
{% endblock %}
