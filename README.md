# Good Deed Map

Проект "Good Deed Map" — веб-приложение, реализованное на Django. Оно создано для учёта и отображения всех НКО (некоммерческих организаций) на интерактивной карте, быстрого поиска необходимых организаций, а также быстрого создания новых профилей организаций.

**Разработчики "Good Deed Map"**

- Лазарев Никита Андреевич – Разработка логики сервера, создание API (интерфейс программирования приложений)
- Кульнев Фёдор Алексеевич – UI/UX-дизайн, Фронтенд-разработка
- Терновский Андрей Денисович – Проектирование структуры БД, создание и поддержка БД

**Как зарегистрироваться на сайте?**

- Кликнуть на кнопку “Войти”
- Кликнуть на гиперссылку “Ещё нет аккаунта?”
- Корректно заполнить все поля для ввода.

**Как добавить новое НКО?**

- Быть зарегистрированным на сайте;
- Кликнуть на кнопку “Добавьте первую!” на главной странице;
- Корректно заполнить все поля для ввода;
- Подождать, пока модерация одобрит НКО и добавит на карту.

**Как найти необходимое НКО на интерактивной карте?**

- Использовать поисковую строку на главной странице;
- Использовать фильтры по городам или категориям.

**Ключевые возможности**

- Управление организациями (НКО)
- Администрирование через панель Django
- Удобная фильтрация и поиск
- Передача прав на управление НКО

**Текущая структура (основное)**

- **`manage.py`**: точка входа для управления проектом.
- **`db.sqlite3`**: локальная база данных SQLite (по умолчанию в репозитории).
- **`good_deed_map/`**: Django-проект (настройки, URL, WSGI/ASGI).
- **`nko/`**: основное приложение для НКО — модели, представления, админ, management-команды.
- **`users/`**: приложение, связанное с пользователями и аутентификацией.
- **`initial_data/`**: CSV-файлы для загрузки начальных данных (`nko.csv`, `category.csv`, `cities.csv`, и т.д.).
- **`media/`**: медиа-файлы (например, `nko_logos/`).
- **`static/` и `staticfiles/`**: статические ресурсы для разработки и собранные статики.

**Быстрый старт (Windows, PowerShell)**

1. Убедитесь, что установлен Python 3.8+, `pip` и Node.js с npm.
2. (Опционально) создайте виртуальное окружение и активируйте его:

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
```

3. Установите Python-зависимости:

```powershell
pip install -r requirements.txt
```

4. Установите npm-зависимости для работы с Tailwind CSS:

```powershell
npm install
```

5. Соберите CSS-файлы:

```powershell
npm run build:css
```

   Для разработки с автоматической пересборкой можно использовать:

```powershell
npm run watch:css
```

6. Выполните миграции:

```powershell
python manage.py makemigrations users nko
python manage.py migrate
```

7. (Опционально) создайте суперпользователя для доступа в админку:

```powershell
python manage.py createsuperuser
```

8. Загрузите начальные данные (есть management-команда `load_initial_data`):

```powershell
python manage.py load_initial_data
```

9. Создайте файл `.env` в корне проекта со следующими переменными:

```text
YANDEX_MAPS_API_KEY=

EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

EMAIL_HOST=smtp.yandex.ru
EMAIL_PORT=465
EMAIL_USE_SSL=True
EMAIL_USE_TLS=False

EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=

DEFAULT_FROM_EMAIL=

DEBUG=
SECRET_KEY=
ALLOWED_HOSTS=
```

10. Запустите сервер разработки:

```powershell
python manage.py runserver
```

Откройте в браузере `http://127.0.0.1:8000/` и `http://127.0.0.1:8000/admin/`.

**Пояснения к переменным в `.env`:**

- `YANDEX_MAPS_API_KEY`: API-ключ Яндекс.Карт. Нужен для отображения карты и геокодирования адресов.
- `EMAIL_BACKEND`: Бекенд для отправки почты в Django. Оставьте `django.core.mail.backends.smtp.EmailBackend` для SMTP.
- `EMAIL_HOST`: SMTP-сервер — для Яндекса используйте `smtp.yandex.ru`.
- `EMAIL_PORT`: Порт SMTP — `465` для SSL, `587` для STARTTLS.
- `EMAIL_USE_SSL`: `True` если используете SSL (порт 465). Для STARTTLS используйте `False` и включайте `EMAIL_USE_TLS=True`.
- `EMAIL_USE_TLS`: `True` для STARTTLS (обычно с портом 587). При `EMAIL_USE_SSL=True` оставьте `False`.
- `EMAIL_HOST_USER`: Логин почтового ящика (обычно полный email), от имени которого будут отправляться письма.
- `EMAIL_HOST_PASSWORD`: Пароль/пароль приложения для почтового ящика.
- `DEFAULT_FROM_EMAIL`: Адрес отправителя по умолчанию, например `no-reply@example.com`.
- `DEBUG`: `True` или `False`. Для разработки `True`, для продакшена обязательно `False`.
- `SECRET_KEY`: Секретный ключ Django. Должен быть уникальным и держаться в секрете (можно сгенерить на любом сайте).
- `ALLOWED_HOSTS`: Список разрешённых хостов. Для локальной разработки `ALLOWED_HOSTS=127.0.0.1,localhost`.

**Статические файлы и медиа**

- Для разработки фронтенда используйте `npm run watch:css` для автоматической пересборки Tailwind CSS при изменениях.
- Для продакшена соберите CSS командой `npm run build:css`, затем выполните сбор статики:

```powershell
python manage.py collectstatic
```

- Медиа-файлы (логотипы) находятся в `media/nko_logos` и уже учитываются в проекте.

**Разработка и отладка**

- Код приложения в `nko/` и `users/`.
- Шаблоны находятся в `templates/`, статика в `static/`.
- Локальная база — `db.sqlite3`.

**Лицензия**
MIT
